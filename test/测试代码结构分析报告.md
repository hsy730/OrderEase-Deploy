# OrderEase æµ‹è¯•ä»£ç ç»“æ„åˆ†æä¸è°ƒç”¨å…³ç³»è¯„ä¼°æŠ¥å‘Š

ç”Ÿæˆæ—¶é—´ï¼š2025-01-04
åˆ†æä»£ç é‡ï¼šçº¦ 5,000 è¡Œæµ‹è¯•ä»£ç 
åˆ†æèŒƒå›´ï¼šOrderEase-Deploy/test ç›®å½•

---

## ä¸€ã€æµ‹è¯•æ¶æ„æ¦‚å†µ

### 1.1 æ¶æ„ç±»å‹ä¸è¯„åˆ†

- **æ¶æ„ç±»å‹**ï¼šæ··åˆæ¶æ„ï¼ˆæ¨¡å—åŒ–åˆ†å±‚ + ä¸šåŠ¡æµç¨‹ç¼–æ’ï¼‰
- **è€¦åˆåº¦è¯„åˆ†**ï¼šâ–¡ ä½ â˜‘ ä¸­ â–¡ é«˜
- **å¯æ‰©å±•æ€§**ï¼šâ–¡ å®¹æ˜“ â˜‘ ä¸€èˆ¬ â–¡ å›°éš¾

### 1.2 æ ¸å¿ƒè°ƒç”¨æ¨¡å¼

- **ä¸»è¦å…¥å£**ï¼š
  - pytest å‘½ä»¤è¡Œï¼š`pytest -v [test_file]`
  - Python è„šæœ¬ï¼š`run_business_flow_tests.py`, `run_all_tests.py`

- **å‘ç°æœºåˆ¶**ï¼špytest æ–‡ä»¶åçº¦å®šï¼ˆtest_*.pyï¼‰
- **æ‰§è¡Œç­–ç•¥**ï¼šä¸²è¡Œæ‰§è¡Œï¼ˆé€šè¿‡ conftest.py ä¸­çš„ pytest_collection_modifyitems å¼ºåˆ¶æ’åºï¼‰

---

## äºŒã€æµ‹è¯•æ¶æ„å±‚çº§åˆ†æ

### 2.1 ç‰©ç†ç»“æ„ï¼ˆç›®å½•å¸ƒå±€ï¼‰

```
OrderEase-Deploy/test/
â”œâ”€â”€ conftest.py                    # å…¨å±€é…ç½®ä¸fixtureå®šä¹‰ï¼ˆ453è¡Œï¼Œæ ¸å¿ƒï¼‰
â”œâ”€â”€ pytest.ini                     # pytesté…ç½®
â”œâ”€â”€ .env                           # ç¯å¢ƒå˜é‡
â”œâ”€â”€ requirements.txt                # ä¾èµ–ç®¡ç†
â”œâ”€â”€ run_*.py                       # æµ‹è¯•æ‰§è¡Œè„šæœ¬ï¼ˆ6ä¸ªï¼‰
â”œâ”€â”€ setup_test_data.py             # æµ‹è¯•æ•°æ®åˆå§‹åŒ–
â”‚
â”œâ”€â”€ admin/                         # ç®¡ç†å‘˜æµ‹è¯•æ¨¡å—
â”‚   â”œâ”€â”€ *actions.py                # ä¸šåŠ¡æ“ä½œå·¥å…·ç±»ï¼ˆ5ä¸ªï¼‰
â”‚   â”œâ”€â”€ test_business_flow.py      # ä¸šåŠ¡æµç¨‹ç¼–æ’ï¼ˆå”¯ä¸€æ‰§è¡Œæ–‡ä»¶ï¼‰
â”‚   â”œâ”€â”€ test_*.py.bak              # æ—§ç‰ˆæµ‹è¯•æ–‡ä»¶ï¼ˆå·²åºŸå¼ƒï¼‰
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ shop_owner/                    # å•†å®¶æµ‹è¯•æ¨¡å—
â”‚   â”œâ”€â”€ test_business_flow.py      # å•†å®¶ä¸šåŠ¡æµç¨‹
â”‚   â””â”€â”€ test_*.py.bak              # æ—§ç‰ˆæµ‹è¯•æ–‡ä»¶ï¼ˆå·²åºŸå¼ƒï¼‰
â”‚
â”œâ”€â”€ auth/                          # è®¤è¯æµ‹è¯•æ¨¡å—
â”‚   â”œâ”€â”€ test_auth_flow.py          # è®¤è¯æµç¨‹æµ‹è¯•
â”‚   â””â”€â”€ test_unauthorized.py
â”‚
â””â”€â”€ frontend/                      # å‰ç«¯æµ‹è¯•æ¨¡å—
    â”œâ”€â”€ test_frontend_flow.py      # å‰ç«¯ä¸šåŠ¡æµç¨‹
    â””â”€â”€ test_*.py
```

**ç‰©ç†ç»“æ„è¯„ä»·**ï¼š
- âœ… æ¸…æ™°çš„æ¨¡å—åŒ–åˆ’åˆ†ï¼ŒæŒ‰ä¸šåŠ¡è§’è‰²åˆ†å±‚
- âš ï¸ å­˜åœ¨å¤§é‡ .bak åºŸå¼ƒæ–‡ä»¶æœªæ¸…ç†ï¼ˆçº¦15ä¸ªï¼‰

### 2.2 é€»è¾‘ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æµ‹è¯•å¥—ä»¶å±‚çº§                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. ä¸šåŠ¡æµç¨‹æµ‹è¯•                        â”‚
â”‚     - admin/test_business_flow.py       â”‚
â”‚     - shop_owner/test_business_flow.py â”‚
â”‚     - frontend/test_frontend_flow.py   â”‚
â”‚     - auth/test_auth_flow.py            â”‚
â”‚                                         â”‚
â”‚  2. ç‹¬ç«‹åŠŸèƒ½æµ‹è¯•                        â”‚
â”‚     - auth/test_unauthorized.py         â”‚
â”‚     - frontend/test_*.py               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é€»è¾‘ç»“æ„è¯„ä»·**ï¼š
- âœ… ä¸šåŠ¡æµç¨‹æµ‹è¯•æ•´åˆåˆç†
- âš ï¸ éƒ¨åˆ†ç‹¬ç«‹æµ‹è¯•ä¸ä¸šåŠ¡æµç¨‹æµ‹è¯•åŠŸèƒ½é‡å¤

---

## ä¸‰ã€è°ƒç”¨å…³ç³»æ·±åº¦åˆ†æ

### 3.1 æ ¸å¿ƒè°ƒç”¨é“¾

#### å…¥å£åˆ°ç”¨ä¾‹æ‰§è¡Œè·¯å¾„

```
pytestå‘½ä»¤è¡Œ/è„šæœ¬
    â†“
conftest.pyåŠ è½½
    â†“
pytest_collection_modifyitemsæ’åº
    â†“
fixtureæ³¨å…¥
    â†“
ä¸šåŠ¡æµç¨‹æµ‹è¯•ç±»
    â†“
actionså·¥å…·ç±»
    â†“
APIè¯·æ±‚
    â†“
æ–­è¨€éªŒè¯
```

#### Fixtureä¾èµ–é“¾ï¼ˆå…³é”®ä¾èµ–ï¼‰

```
Sessionçº§åˆ«fixtures:
â”œâ”€â”€ api_base_url (åŸºç¡€URL)
â”œâ”€â”€ admin_token (ç®¡ç†å‘˜token)
â”‚   â””â”€â”€ ä¾èµ–: APIç™»å½•æ¥å£
â”‚
â”œâ”€â”€ shop_owner_token (å•†å®¶token)
â”‚   â”œâ”€â”€ ä¾èµ–: admin_token (åˆ›å»ºåº—é“ºéœ€è¦)
â”‚   â””â”€â”€ æµç¨‹: adminç™»å½• â†’ åˆ›å»ºåº—é“º â†’ å•†å®¶ç™»å½•
â”‚
â”œâ”€â”€ test_shop_id
â”‚   â””â”€â”€ ä¾èµ–: admin_token
â”‚
â”œâ”€â”€ test_product_id
â”‚   â”œâ”€â”€ ä¾èµ–: admin_token, test_shop_id
â”‚   â””â”€â”€ è¡¥å……é€»è¾‘: ä¸å­˜åœ¨æ—¶è‡ªåŠ¨åˆ›å»º
â”‚
â””â”€â”€ test_order_id
    â””â”€â”€ ä¾èµ–: admin_token, test_shop_id
```

**é—®é¢˜è¯†åˆ«**ï¼š
- âš ï¸ shop_owner_token å­˜åœ¨åµŒå¥—ä¾èµ–ï¼ˆadmin_tokenï¼‰
- âš ï¸ test_product_id æœ‰è‡ªåŠ¨åˆ›å»ºé€»è¾‘ï¼Œè¿åæµ‹è¯•éš”ç¦»åŸåˆ™

### 3.2 å…³é”®å…³ç³»å‘ç°

#### 1. ç´§å¯†è€¦åˆç°‡ï¼šè®¤è¯tokenç®¡ç†

**è€¦åˆåŸå› **ï¼šJWTä»¤ç‰Œé»‘åå•æœºåˆ¶å¯¼è‡´æ‰§è¡Œé¡ºåºå¼ºä¾èµ–

**å…·ä½“è¡¨ç°**ï¼š

```python
# conftest.py ç¬¬424-452è¡Œ
def pytest_collection_modifyitems(config, items):
    """å¼ºåˆ¶è°ƒæ•´æµ‹è¯•æ‰§è¡Œé¡ºåºï¼Œé¿å…tokené»‘åå•é—®é¢˜"""
    priority_map = {
        "test_frontend_flow.py": 0,  # æœ€å…ˆæ‰§è¡Œï¼ˆä½¿ç”¨admin_tokenï¼‰
        "test_auth_flow.py": 100,    # æœ€åæ‰§è¡Œï¼ˆä¼šç™»å‡ºä½¿tokenå¤±æ•ˆï¼‰
    }
```

**å½±å“èŒƒå›´**ï¼šæ‰€æœ‰ä½¿ç”¨ admin_token çš„æµ‹è¯•ç”¨ä¾‹ï¼ˆçº¦ 200+ ä¸ªï¼‰

**é£é™©ç­‰çº§**ï¼šğŸ”´ é«˜

**é—®é¢˜**ï¼š
1. test_auth_flow.py ä¼šè°ƒç”¨ç™»å‡ºæ¥å£ï¼Œå°† admin_token åŠ å…¥é»‘åå•
2. å¦‚æœ test_auth_flow.py å…ˆæ‰§è¡Œï¼Œåç»­æµ‹è¯•çš„ admin_token ä¼šå¤±æ•ˆ
3. é€šè¿‡ pytest_collection_modifyitems å¼ºåˆ¶æ’åºè§£å†³ï¼Œä½†è¿™æ˜¯ä¸€ç§è„†å¼±çš„è¡¥ä¸

#### 2. ç±»å˜é‡å…±äº«çŠ¶æ€

**è€¦åˆåŸå› **ï¼šä½¿ç”¨ç±»å˜é‡åœ¨æµ‹è¯•æ–¹æ³•é—´ä¼ é€’æ•°æ®

**å…·ä½“è¡¨ç°**ï¼š

```python
# frontend/test_frontend_flow.py ç¬¬33-40è¡Œ
class TestFrontendFlow:
    # ç±»å˜é‡ï¼Œç”¨äºåœ¨æµ‹è¯•ç”¨ä¾‹ä¹‹é—´å…±äº«æ•°æ®
    frontend_username = None
    frontend_user_id = None
    frontend_token = None
    frontend_shop_id = None
    frontend_product_id = None
    frontend_order_id = None
```

**å½±å“èŒƒå›´**ï¼šfrontend/test_frontend_flow.py ä¸­çš„ 11 ä¸ªæµ‹è¯•æ–¹æ³•

**é£é™©ç­‰çº§**ï¼šğŸŸ¡ ä¸­

**é—®é¢˜**ï¼š
1. æµ‹è¯•æ‰§è¡Œé¡ºåºä¾èµ–ï¼ˆtest_create_shop å¿…é¡»åœ¨ test_create_order ä¹‹å‰ï¼‰
2. å¦‚æœä¸­é—´æŸä¸ªæµ‹è¯•å¤±è´¥ï¼Œåç»­æµ‹è¯•å¯èƒ½å› ç¼ºå°‘æ•°æ®è€Œå¤±è´¥
3. æ— æ³•å¹¶è¡Œæ‰§è¡Œæµ‹è¯•

#### 3. cleanupèµ„æºç®¡ç†æœºåˆ¶

**è®¾è®¡æ¨¡å¼**ï¼šä½¿ç”¨æ ˆå¼cleanupä¿è¯èµ„æºæ¸…ç†

**å…·ä½“è¡¨ç°**ï¼š

```python
# admin/test_business_flow.py ç¬¬30-47è¡Œ
@pytest.fixture(scope="function", autouse=True)
def setup_and_teardown(self, admin_token):
    """æ¯ä¸ªæµ‹è¯•å‡½æ•°å‰åçš„ setup å’Œ teardown"""
    self.cleanup_resources = []
    
    yield  # æ‰§è¡Œæµ‹è¯•
    
    # Teardown: æŒ‰åå‘é¡ºåºæ¸…ç†
    for cleanup_func in reversed(self.cleanup_resources):
        try:
            cleanup_func()
        except Exception as e:
            print(f"æ¸…ç†èµ„æºæ—¶å‡ºé”™: {e}")
```

**å½±å“èŒƒå›´**ï¼šadmin/test_business_flow.py ä¸­çš„æ‰€æœ‰æµ‹è¯•

**é£é™©ç­‰çº§**ï¼šğŸŸ¢ ä½

**ä¼˜ç‚¹**ï¼š
- âœ… æ ˆå¼æ¸…ç†ä¿è¯ä¾èµ–é¡ºåºæ­£ç¡®
- âœ… å¼‚å¸¸æ•è·é¿å…æ¸…ç†å¤±è´¥å¯¼è‡´æµ‹è¯•ç»“æœè¯¯åˆ¤

### 3.3 ç‹¬ç«‹ç”¨ä¾‹ç»„

**è¯†åˆ«çš„å¯ç‹¬ç«‹è¿è¡Œç”¨ä¾‹**ï¼š

| æ¨¡å— | æµ‹è¯•æ–‡ä»¶ | éš”ç¦»ç¨‹åº¦ | å¹¶è¡ŒåŒ–æ½œåŠ› |
|------|---------|---------|-----------|
| è®¤è¯æµ‹è¯• | auth/test_unauthorized.py | å®Œå…¨ç‹¬ç«‹ | é«˜ |
| å‚æ•°æ ¡éªŒ | auth/test_parameter_validation.py | å®Œå…¨ç‹¬ç«‹ | é«˜ |
| è¾¹ç•Œæµ‹è¯• | auth/test_boundary_conditions.py | å®Œå…¨ç‹¬ç«‹ | é«˜ |

**å…±äº«èµ„æºä¾èµ–**ï¼š
- æ‰€æœ‰æµ‹è¯•å…±äº«ï¼šAPI_BASE_URLï¼ˆåªè¯»ï¼Œå®‰å…¨ï¼‰
- æ‰€æœ‰æµ‹è¯•å…±äº«ï¼šMySQLæ•°æ®åº“ï¼ˆâš ï¸ æ½œåœ¨å†²çªç‚¹ï¼‰

---

## å››ã€ç»“æ„å¥åº·åº¦è¯„ä¼°

### 4.1 æ¨¡å—åŒ–ç¨‹åº¦

#### âœ… ä¼˜ç‚¹

1. **Actionså·¥å…·ç±»è®¾è®¡è‰¯å¥½**
   - `admin/` ç›®å½•ä¸‹çš„ `*_actions.py` æ–‡ä»¶å°è£…äº†ä¸šåŠ¡æ“ä½œ
   - APIæ¸…æ™°ï¼Œæ˜“äºå¤ç”¨å’Œç»´æŠ¤
   - ç¤ºä¾‹ï¼š`shop_actions.py` (270è¡Œ) æä¾›äº†å®Œæ•´çš„åº—é“ºCRUDæ“ä½œ

2. **ä¸šåŠ¡æµç¨‹æµ‹è¯•æ•´åˆåˆç†**
   - å°†æœ‰ä¾èµ–å…³ç³»çš„æµ‹è¯•æ•´åˆåˆ° `test_business_flow.py`
   - é¿å…äº†æµ‹è¯•é—´çš„éšå¼ä¾èµ–

#### âš ï¸ é—®é¢˜

1. **æµ‹è¯•æ•°æ®å·¥å‚ç¼ºå¤±**
   - å½“å‰æµ‹è¯•æ•°æ®åˆ†æ•£åœ¨å„ä¸ªfixtureå’Œæµ‹è¯•æ–¹æ³•ä¸­
   - ç¼ºå°‘ç»Ÿä¸€çš„æµ‹è¯•æ•°æ®æ„å»ºæ¨¡å¼
   - ç¤ºä¾‹ï¼šæ¯ä¸ªæµ‹è¯•éƒ½åœ¨å†…è”åˆ›å»ºåº—é“º/å•†å“/è®¢å•

2. **Mock/Stubå®šä¹‰ä¸ç»Ÿä¸€**
   - æœªä½¿ç”¨mockåº“ï¼Œå…¨éƒ¨ä¾èµ–çœŸå®API
   - ä¼˜ç‚¹ï¼šæµ‹è¯•çœŸå®æ€§å¼º
   - ç¼ºç‚¹ï¼šä¾èµ–å¤–éƒ¨æœåŠ¡ï¼Œæµ‹è¯•ä¸ç¨³å®š

### 4.2 åˆ†å±‚è®¾è®¡

#### å½“å‰åˆ†å±‚

```
åŸºç¡€å±‚ï¼ˆFoundationï¼‰ï¼š
â”œâ”€â”€ conftest.pyï¼ˆfixturesã€å·¥å…·å‡½æ•°ï¼‰
â””â”€â”€ *_actions.pyï¼ˆä¸šåŠ¡æ“ä½œå·¥å…·ï¼‰

ä¸šåŠ¡å±‚ï¼ˆBusinessï¼‰ï¼š
â”œâ”€â”€ test_business_flow.pyï¼ˆæµç¨‹ç¼–æ’ï¼‰
â””â”€â”€ test_*.pyï¼ˆç‹¬ç«‹æµ‹è¯•ï¼‰

æ¥å£å±‚ï¼ˆInterfaceï¼‰ï¼š
â”œâ”€â”€ HTTPè¯·æ±‚ï¼ˆrequestsï¼‰
â””â”€â”€ APIå“åº”
```

**è¯„åˆ†**ï¼š3/5 â­â­â­â˜†â˜†

**é—®é¢˜**ï¼š
- ç¼ºå°‘æŠ½è±¡å±‚ï¼Œæ‰€æœ‰æµ‹è¯•ç›´æ¥è°ƒç”¨HTTP API
- æ— ç»Ÿä¸€é”™è¯¯å¤„ç†

### 4.3 æ¥å£è®¾è®¡

#### conftest.py APIè¯„ä»·

**ä¼˜ç‚¹**ï¼š
- âœ… `make_request_with_retry()` æä¾›äº†429é”™è¯¯é‡è¯•æœºåˆ¶
- âœ… `assert_response_status()` ç»Ÿä¸€æ–­è¨€é€»è¾‘

**é—®é¢˜**ï¼š
- âš ï¸ fixtureæ•°é‡è¿‡å¤šï¼ˆ15+ä¸ªï¼‰ï¼Œéƒ¨åˆ†å­˜åœ¨é‡å¤åŠŸèƒ½
- âš ï¸ `test_token` fixtureå·²åºŸå¼ƒä½†ä»ä¿ç•™

---

## äº”ã€åæ¨¡å¼æ£€æµ‹

### 5.1 å·²è¯†åˆ«åæ¨¡å¼

| åæ¨¡å¼ | ä½ç½® | é£é™©ç­‰çº§ | å½±å“ |
|--------|------|---------|------|
| **æµ‹è¯•é“¾** | test_frontend_flow.py ç±»å˜é‡å…±äº« | ğŸŸ¡ ä¸­ | æ‰§è¡Œé¡ºåºä¾èµ–ï¼Œæ— æ³•å¹¶è¡Œ |
| **éšè—ä¾èµ–** | test_product_id fixtureè‡ªåŠ¨åˆ›å»ºå•†å“ | ğŸŸ¡ ä¸­ | è¿åæµ‹è¯•éš”ç¦»åŸåˆ™ |
| **æ‰§è¡Œé¡ºåºå‡è®¾** | pytest_collection_modifyitems | ğŸ”´ é«˜ | è„†å¼±çš„æ’åºæœºåˆ¶ |
| **è¿‡åº¦å‚æ•°åŒ–** | shop_owner_business_flowæµ‹è¯• | ğŸŸ¢ ä½ | æ¯ä¸ªæµ‹è¯•ç”Ÿæˆéšæœºåç¼€ï¼Œå¯è¯»æ€§é™ä½ |

### 5.2 ç¤ºä¾‹ä»£ç åˆ†æ

#### åæ¨¡å¼1ï¼šæµ‹è¯•é“¾ï¼ˆTest Chainingï¼‰

```python
# frontend/test_frontend_flow.py
class TestFrontendFlow:
    # ç±»å˜é‡åœ¨æ–¹æ³•é—´å…±äº«
    frontend_shop_id = None
    frontend_product_id = None
    
    def test_create_shop(self, admin_token):
        self.frontend_shop_id = create_shop()  # å†™å…¥å…±äº«çŠ¶æ€
    
    def test_create_order(self, admin_token):
        # ä¾èµ–å‰é¢çš„æµ‹è¯•è®¾ç½®çš„æ•°æ®
        assert self.frontend_shop_id  # è¯»å–å…±äº«çŠ¶æ€
        create_order(self.frontend_shop_id)
```

**é—®é¢˜**ï¼šå¦‚æœ test_create_shop å¤±è´¥ï¼Œtest_create_order å¿…ç„¶å¤±è´¥

**é‡æ„å»ºè®®**ï¼šä½¿ç”¨ pytest çš„ `fixture` ä¾èµ–æ³¨å…¥æœºåˆ¶

```python
# æ¨èæ–¹å¼
@pytest.fixture
def shop_id(admin_token):
    return create_shop(admin_token)

def test_create_order(shop_id, admin_token):
    create_order(shop_id)
```

#### åæ¨¡å¼2ï¼šéšè—ä¾èµ–

```python
# conftest.py ç¬¬189-235è¡Œ
@pytest.fixture(scope="session")
def test_product_id(admin_token, test_shop_id):
    """æµ‹è¯•å•†å“ID fixture - ä»æ•°æ®åº“è·å–ç¬¬ä¸€ä¸ªå•†å“IDï¼Œå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»º"""
    # å…ˆå°è¯•è·å–
    products = get_product_list(...)
    if products:
        return products[0].get("id")
    
    # âš ï¸ éšè—é€»è¾‘ï¼šè‡ªåŠ¨åˆ›å»ºå•†å“
    print(f"åº—é“º {test_shop_id} ä¸­æ²¡æœ‰å•†å“ï¼Œåˆ›å»ºæµ‹è¯•å•†å“")
    product_id = create_product(...)
    return product_id
```

**é—®é¢˜**ï¼š
1. æµ‹è¯•è°ƒç”¨è€…ä¸çŸ¥é“fixtureå¯èƒ½åˆ›å»ºæ•°æ®
2. è¿å"æµ‹è¯•éš”ç¦»"åŸåˆ™
3. å¯èƒ½å¯¼è‡´å…¶ä»–æµ‹è¯•äº§ç”Ÿå‰¯ä½œç”¨

#### åæ¨¡å¼3ï¼šæ‰§è¡Œé¡ºåºå‡è®¾

```python
# conftest.py ç¬¬424-452è¡Œ
def pytest_collection_modifyitems(config, items):
    """è°ƒæ•´æµ‹è¯•æ‰§è¡Œé¡ºåºï¼Œç¡®ä¿ test_frontend_flow.py åœ¨ test_auth_flow.py ä¹‹å‰æ‰§è¡Œ
    
    å› ä¸º test_auth_flow.py ä¼šç™»å‡º admin_tokenï¼Œå¯¼è‡´ token åŠ å…¥é»‘åå•ã€‚
    """
    priority_map = {
        "test_frontend_flow.py": 0,  # æœ€å…ˆæ‰§è¡Œ
        "test_auth_flow.py": 100,    # æœ€åæ‰§è¡Œ
    }
    items.sort(key=get_test_priority)
```

**é—®é¢˜**ï¼š
1. æš´éœ²äº†æµ‹è¯•ä»£ç çš„è®¾è®¡ç¼ºé™·ï¼ˆtokenç®¡ç†æ··ä¹±ï¼‰
2. å¼ºåˆ¶æ’åºé™åˆ¶äº†å¹¶è¡ŒåŒ–
3. æ–°å¢æµ‹è¯•æ–‡ä»¶éœ€è¦æ‰‹åŠ¨ç»´æŠ¤ä¼˜å…ˆçº§æ˜ å°„

---

## å…­ã€æ”¹è¿›å»ºè®®

### çŸ­æœŸä¼˜åŒ–ï¼ˆ1-2å‘¨ï¼‰

#### é—®é¢˜1ï¼štokené»‘åå•å¯¼è‡´çš„æ‰§è¡Œé¡ºåºä¾èµ–

**å»ºè®®æ–¹æ¡ˆ**ï¼šä½¿ç”¨ç‹¬ç«‹çš„æµ‹è¯•è´¦æˆ·

```python
# conftest.py
@pytest.fixture(scope="session")
def admin_test_token():
    """ä¸“ç”¨äºæµ‹è¯•çš„ç®¡ç†å‘˜tokenï¼Œä¸ä¼šè¢«ç™»å‡º"""
    url = f"{API_BASE_URL}/login"
    payload = {
        "username": "test_admin",  # ä¸“ç”¨æµ‹è¯•è´¦æˆ·
        "password": "Test@123456"
    }
    response = requests.post(url, json=payload)
    return response.json().get("token")

@pytest.fixture(scope="session")
def admin_real_token():
    """çœŸå®ç®¡ç†å‘˜tokenï¼Œç”¨äºæµ‹è¯•ç™»å‡ºåŠŸèƒ½"""
    # ... ç°æœ‰é€»è¾‘
```

**å½±å“ç”¨ä¾‹**ï¼šæ‰€æœ‰ä¾èµ– admin_token çš„æµ‹è¯•ï¼ˆçº¦150ä¸ªï¼‰

---

#### é—®é¢˜2ï¼šç±»å˜é‡å…±äº«çŠ¶æ€

**å»ºè®®æ–¹æ¡ˆ**ï¼šä½¿ç”¨fixtureé“¾å¼ä¾èµ–

```python
# frontend/test_frontend_flow.pyï¼ˆé‡æ„åï¼‰
@pytest.fixture
def frontend_user():
    """åˆ›å»ºå¹¶è¿”å›å‰ç«¯ç”¨æˆ·"""
    username = f"test_user_{os.urandom(4).hex()}"
    response = requests.post(f"{API_BASE_URL}/user/register", json={
        "username": username,
        "password": "Test@123456"
    })
    user_id = response.json().get("id")
    
    # cleanup
    yield {"username": username, "id": user_id}
    # æ¸…ç†é€»è¾‘...

@pytest.fixture
def frontend_shop(admin_token, frontend_user):
    """åˆ›å»ºæµ‹è¯•åº—é“º"""
    shop_id = create_shop(admin_token, owner_id=frontend_user["id"])
    yield {"id": shop_id}
    # æ¸…ç†é€»è¾‘...

def test_frontend_user_registration(frontend_user):
    """ç‹¬ç«‹çš„å‰ç«¯ç”¨æˆ·æ³¨å†Œæµ‹è¯•"""
    assert frontend_user["id"] is not None

def test_frontend_shop_creation(frontend_shop):
    """ç‹¬ç«‹çš„åº—é“ºåˆ›å»ºæµ‹è¯•"""
    assert frontend_shop["id"] is not None

def test_frontend_order_creation(frontend_user, frontend_shop):
    """è®¢å•åˆ›å»ºæµ‹è¯•ï¼Œä¾èµ–ç”¨æˆ·å’Œåº—é“º"""
    order_id = create_order(frontend_user["id"], frontend_shop["id"])
    assert order_id is not None
```

**ä¼˜ç‚¹**ï¼š
- âœ… æµ‹è¯•å¯ä»¥ç‹¬ç«‹è¿è¡Œ
- âœ… ä¾èµ–å…³ç³»æ˜¾å¼å£°æ˜
- âœ… æ”¯æŒpytestå¹¶è¡Œæ‰§è¡Œï¼ˆpytest-xdistï¼‰

---

#### é—®é¢˜3ï¼šfixtureè‡ªåŠ¨åˆ›å»ºé€»è¾‘

**å»ºè®®æ–¹æ¡ˆ**ï¼šç§»é™¤è‡ªåŠ¨åˆ›å»ºé€»è¾‘ï¼Œæ”¹ç”¨æ˜¾å¼åˆ›å»º

```python
# conftest.pyï¼ˆä¿®å¤åï¼‰
@pytest.fixture(scope="session")
def test_product_id(admin_token, test_shop_id):
    """æµ‹è¯•å•†å“ID fixture - ä»æ•°æ®åº“è·å–ç¬¬ä¸€ä¸ªå•†å“ID"""
    url = f"{API_BASE_URL}/admin/product/list"
    params = {
        "page": 1,
        "pageSize": 1,
        "shop_id": str(test_shop_id)
    }
    response = requests.get(url, params=params, 
                          headers={"Authorization": f"Bearer {admin_token}"})
    
    if response.status_code == 200:
        data = response.json()
        products = data.get("data", data.get("products", []))
        if products:
            return products[0].get("id")
    
    # âŒ ä¸å†è‡ªåŠ¨åˆ›å»ºï¼Œè¿”å›Noneå¹¶æç¤ºç”¨æˆ·
    print(f"âš ï¸ è­¦å‘Šï¼šåº—é“º {test_shop_id} ä¸­æ²¡æœ‰æµ‹è¯•å•†å“ï¼Œè¯·å…ˆè¿è¡Œ setup_test_data.py")
    return None
```

---

### ä¸­æœŸé‡æ„ï¼ˆ1-2æœˆï¼‰

#### æ¶æ„è°ƒæ•´

**ç›®æ ‡**ï¼šå¼•å…¥æµ‹è¯•åˆ†å±‚å’Œç»Ÿä¸€æ•°æ®å·¥å‚

```python
# æµ‹è¯•æ¶æ„é‡æ„ï¼ˆå»ºè®®ï¼‰
test/
â”œâ”€â”€ conftest.py                    # å…¨å±€é…ç½®
â”œâ”€â”€ fixtures/                      # Fixtureæ¨¡å—åŒ–
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ auth_fixtures.py          # è®¤è¯ç›¸å…³fixtures
â”‚   â”œâ”€â”€ data_fixtures.py          # æµ‹è¯•æ•°æ®fixtures
â”‚   â””â”€â”€ resource_fixtures.py      # èµ„æºæ¸…ç†fixtures
â”‚
â”œâ”€â”€ factories/                     # æ•°æ®å·¥å‚æ¨¡å¼
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ shop_factory.py           # åº—é“ºæ•°æ®æ„å»ºå™¨
â”‚   â”œâ”€â”€ product_factory.py        # å•†å“æ•°æ®æ„å»ºå™¨
â”‚   â”œâ”€â”€ order_factory.py          # è®¢å•æ•°æ®æ„å»ºå™¨
â”‚   â””â”€â”€ user_factory.py           # ç”¨æˆ·æ•°æ®æ„å»ºå™¨
â”‚
â”œâ”€â”€ helpers/                       # æµ‹è¯•è¾…åŠ©å·¥å…·
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ api_helper.py             # APIè¯·æ±‚å°è£…
â”‚   â”œâ”€â”€ assert_helper.py           # æ–­è¨€è¾…åŠ©
â”‚   â””â”€â”€ data_helper.py            # æ•°æ®æ“ä½œè¾…åŠ©
â”‚
â”œâ”€â”€ admin/                         # ç®¡ç†å‘˜æµ‹è¯•
â”‚   â”œâ”€â”€ test_business_flow.py
â”‚   â””â”€â”€ test_*.py
â”œâ”€â”€ shop_owner/
â”‚   â””â”€â”€ ...
â””â”€â”€ ...
```

**ç¤ºä¾‹ï¼šæ•°æ®å·¥å‚å®ç°**

```python
# factories/shop_factory.py
class ShopFactory:
    """åº—é“ºæ•°æ®æ„å»ºå™¨"""
    
    @staticmethod
    def create(admin_token, **overrides):
        """åˆ›å»ºæµ‹è¯•åº—é“º"""
        default_data = {
            "name": f"Test Shop {uuid.uuid4().hex[:8]}",
            "contact_phone": "13800138000",
            "contact_email": f"test_{uuid.uuid4().hex[:8]}@example.com",
            "description": "Test shop",
            "valid_until": "2027-12-31T23:59:59Z"
        }
        data = {**default_data, **overrides}
        
        # è°ƒç”¨actionså·¥å…·ç±»
        shop_id = shop_actions.create_shop(admin_token, **data)
        return ShopModel(id=shop_id, **data)
    
    @staticmethod
    def cleanup(admin_token, shop_id):
        """æ¸…ç†åº—é“º"""
        return shop_actions.delete_shop(admin_token, shop_id)
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# admin/test_business_flow.py
from factories import ShopFactory, ProductFactory, OrderFactory

def test_complete_flow(admin_token):
    """ä½¿ç”¨æ•°æ®å·¥å‚çš„ç®€åŒ–æµ‹è¯•"""
    shop = ShopFactory.create(admin_token)
    product = ProductFactory.create(admin_token, shop_id=shop.id)
    order = OrderFactory.create(admin_token, shop_id=shop.id, 
                               product_id=product.id)
    
    # ... æµ‹è¯•é€»è¾‘ ...
    
    # cleanupè‡ªåŠ¨å¤„ç†
```

---

#### å·¥å…·å»ºè®¾

**1. ä¾èµ–åˆ†æå·¥å…·**

```python
# tools/analyze_test_dependencies.py
"""
åˆ†ææµ‹è¯•ä¾èµ–å…³ç³»ï¼Œè¯†åˆ«ï¼š
1. Fixtureä¾èµ–é“¾
2. ç±»å˜é‡å…±äº«çŠ¶æ€
3. æµ‹è¯•æ‰§è¡Œé¡ºåºå‡è®¾
"""

def analyze_fixture_dependencies(test_dir):
    """åˆ†æfixtureä¾èµ–å…³ç³»å›¾"""
    # æ‰«ææ‰€æœ‰conftest.pyå’Œtestæ–‡ä»¶
    # è¯†åˆ«fixtureå®šä¹‰å’Œå¼•ç”¨
    # ç”Ÿæˆä¾èµ–å…³ç³»å›¾
    pass

def detect_class_variables(test_files):
    """æ£€æµ‹ç±»å˜é‡å…±äº«çŠ¶æ€"""
    # æ‰«ææµ‹è¯•ç±»ä¸­çš„ç±»å˜é‡
    # æ£€æŸ¥åœ¨æµ‹è¯•æ–¹æ³•ä¸­çš„è¯»å†™
    pass

def generate_dependency_graph(output_file):
    """ç”Ÿæˆä¾èµ–å…³ç³»å¯è§†åŒ–å›¾"""
    # ä½¿ç”¨graphvizç”Ÿæˆä¾èµ–å›¾
    pass
```

**2. å¯è§†åŒ–å·¥å…·**

```python
# tools/visualize_test_structure.py
"""
ç”Ÿæˆæµ‹è¯•ç»“æ„å¯è§†åŒ–æŠ¥å‘Šï¼š
1. ç›®å½•æ ‘
2. ç”¨ä¾‹ä¾èµ–å…³ç³»å›¾
3. Fixtureä¾èµ–é“¾
4. æ‰§è¡Œæ—¶é—´çƒ­åŠ›å›¾
"""
```

---

### é•¿æœŸä¼˜åŒ–ï¼ˆ3-6æœˆï¼‰

#### 1. å¼•å…¥pytest-xdistæ”¯æŒå¹¶è¡Œæµ‹è¯•

**å‰ææ¡ä»¶**ï¼š
- è§£å†³tokené»‘åå•é—®é¢˜
- ç§»é™¤ç±»å˜é‡å…±äº«çŠ¶æ€
- è§£å†³æ•°æ®åº“ç«äº‰æ¡ä»¶

**å®ç°**ï¼š

```python
# conftest.py
def pytest_configure(config):
    """pytest-xdisté…ç½®"""
    if hasattr(config, "workerinput"):
        # æ¯ä¸ªworkerä½¿ç”¨ç‹¬ç«‹çš„æ•°æ®åº“
        worker_id = config.workerinput["workerid"]
        setup_test_database(f"test_db_{worker_id}")
```

**é¢„æœŸæ”¶ç›Š**ï¼š
- æµ‹è¯•æ‰§è¡Œæ—¶é—´å‡å°‘ 60-80%
- æé«˜æŒç»­é›†æˆæ•ˆç‡

---

#### 2. Mockå¤–éƒ¨ä¾èµ–

**å½“å‰é—®é¢˜**ï¼šæ‰€æœ‰æµ‹è¯•ä¾èµ–çœŸå®çš„APIå’Œæ•°æ®åº“

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

```python
# ä½¿ç”¨pytest-mockå’Œresponsesåº“
import responses

@responses.activate
def test_create_order_with_mock():
    """ä½¿ç”¨mockçš„è®¢å•åˆ›å»ºæµ‹è¯•"""
    # mock APIå“åº”
    responses.add(
        responses.POST,
        f"{API_BASE_URL}/order/create",
        json={"order_id": 123},
        status=200
    )
    
    # æ‰§è¡Œæµ‹è¯•
    order_id = create_order(...)
    assert order_id == 123
```

**ä¼˜ç‚¹**ï¼š
- âœ… æµ‹è¯•é€Ÿåº¦å¿«10-100å€
- âœ… ä¸ä¾èµ–å¤–éƒ¨æœåŠ¡
- âœ… å¯ä»¥æ¨¡æ‹Ÿå„ç§å¼‚å¸¸åœºæ™¯

**é€‚ç”¨åœºæ™¯**ï¼š
- å•å…ƒæµ‹è¯•
- æ¥å£é›†æˆæµ‹è¯•
- è¾¹ç•Œæ¡ä»¶æµ‹è¯•

---

#### 3. æµ‹è¯•è¦†ç›–ç‡ä¸è´¨é‡é—¨ç¦

**å®æ–½æ–¹æ¡ˆ**ï¼š

```python
# pytest.ini
[pytest]
addopts = 
    --cov=../OrderEase-Golang/src
    --cov-report=html
    --cov-report=term
    --cov-fail-under=80
```

**CI/CDé›†æˆ**ï¼š

```yaml
# .github/workflows/test.yml
name: Test Coverage
on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Run tests with coverage
        run: |
          cd test
          pytest --cov-report=xml
      - name: Upload coverage to Codecov
        uses: codecov/codecov-action@v3
```

---

## ä¸ƒã€è¯„ä¼°æŒ‡æ ‡

### 7.1 ç»“æ„è´¨é‡è¯„åˆ†ï¼š3.2/5 â­â­â­â˜†â˜†

| ç»´åº¦ | è¯„åˆ† | è¯´æ˜ |
|------|------|------|
| æ¨¡å—åŒ–ç¨‹åº¦ | 3/5 | actionså·¥å…·ç±»è®¾è®¡è‰¯å¥½ï¼Œä½†ç¼ºå°‘æ•°æ®å·¥å‚ |
| æ¸…æ™°åº¦ | 3/5 | ä¸šåŠ¡æµç¨‹æ•´åˆåˆç†ï¼Œä½†å­˜åœ¨å¤§é‡åºŸå¼ƒæ–‡ä»¶ |
| ä¸€è‡´æ€§ | 4/5 | å‘½åå’Œç»“æ„ç›¸å¯¹ç»Ÿä¸€ |
| å¯ç»´æŠ¤æ€§ | 3/5 | éƒ¨åˆ†æµ‹è¯•è€¦åˆåº¦é«˜ï¼Œä¿®æ”¹å½±å“èŒƒå›´å¤§ |

---

### 7.2 è°ƒç”¨å¤æ‚åº¦è¯„åˆ†ï¼š4/5 â­â­â­â­â˜†

| ç»´åº¦ | è¯„åˆ† | è¯´æ˜ |
|------|------|------|
| è°ƒç”¨é“¾æ·±åº¦ | 4/5 | fixtureåµŒå¥—æœ€æ·±3å±‚ï¼Œå¯æ¥å— |
| åˆ†æ”¯æ•°é‡ | 5/5 | åˆ†æ”¯é€»è¾‘æ¸…æ™° |
| ä¾èµ–å…³ç³» | 2/5 | å­˜åœ¨å¼ºè€¦åˆä¾èµ–ï¼ˆtokené»‘åå•ï¼‰ |
| æ‰§è¡Œé¡ºåº | 2/5 | éœ€è¦å¼ºåˆ¶æ’åºï¼Œé™åˆ¶å¹¶è¡ŒåŒ– |

---

### 7.3 è€¦åˆåº¦è¯„åˆ†ï¼š2/5 â­â­â˜†â˜†â˜†

| ç»´åº¦ | è¯„åˆ† | è¯´æ˜ |
|------|------|------|
| æ•°æ®è€¦åˆ | 2/5 | ç±»å˜é‡å…±äº«çŠ¶æ€ |
| çŠ¶æ€è€¦åˆ | 1/5 | tokené»‘åå•å¯¼è‡´å…¨å±€çŠ¶æ€ä¾èµ– |
| æ§åˆ¶è€¦åˆ | 3/5 | å¼ºåˆ¶æ‰§è¡Œé¡ºåº |
| å†…å®¹è€¦åˆ | 4/5 | æ¨¡å—é—´æ¥å£æ¸…æ™° |

---

### 7.4 å¯ç»´æŠ¤æ€§è¯„åˆ†ï¼š2.5/5 â­â­â˜†â˜†â˜†

| ç»´åº¦ | è¯„åˆ† | è¯´æ˜ |
|------|------|------|
| ä¿®æ”¹å½±å“èŒƒå›´ | 2/5 | ä¿®æ”¹conftest.pyå½±å“å…¨å±€ |
| ç†è§£æˆæœ¬ | 3/5 | ä¸šåŠ¡æµç¨‹æµ‹è¯•é€»è¾‘å¤æ‚ |
| è°ƒè¯•éš¾åº¦ | 2/5 | ä¾èµ–å…³ç³»å¤æ‚ï¼Œéš¾ä»¥å®šä½é—®é¢˜ |
| æ‰©å±•æ€§ | 3/5 | æ–°å¢æµ‹è¯•éœ€ç»´æŠ¤æ‰§è¡Œé¡ºåº |

---

## å…«ã€æ€»ç»“ä¸å»ºè®®

### 8.1 æ ¸å¿ƒé—®é¢˜æ€»ç»“

| é—®é¢˜ | ä¼˜å…ˆçº§ | å½±å“ | ä¿®å¤æˆæœ¬ |
|------|--------|------|---------|
| Tokené»‘åå•å¯¼è‡´æ‰§è¡Œé¡ºåºä¾èµ– | ğŸ”´ P0 | å½±å“æ‰€æœ‰æµ‹è¯•ç¨³å®šæ€§ | 2äººæ—¥ |
| ç±»å˜é‡å…±äº«çŠ¶æ€ | ğŸŸ¡ P1 | é™åˆ¶å¹¶è¡Œæ‰§è¡Œ | 3äººæ—¥ |
| Fixtureè‡ªåŠ¨åˆ›å»ºé€»è¾‘ | ğŸŸ¡ P1 | è¿åæµ‹è¯•éš”ç¦»åŸåˆ™ | 1äººæ—¥ |
| ç¼ºå°‘æ•°æ®å·¥å‚æ¨¡å¼ | ğŸŸ¢ P2 | æµ‹è¯•ä»£ç é‡å¤ | 5äººæ—¥ |
| å¤§é‡åºŸå¼ƒæ–‡ä»¶æœªæ¸…ç† | ğŸŸ¢ P3 | ä»£ç åº“æ··ä¹± | 0.5äººæ—¥ |

### 8.2 ä¼˜åŒ–è·¯çº¿å›¾

**ç¬¬1å‘¨ï¼ˆç´§æ€¥ä¿®å¤ï¼‰**ï¼š
1. åˆ›å»ºä¸“ç”¨æµ‹è¯•è´¦æˆ·ï¼Œè§£å†³tokené»‘åå•é—®é¢˜
2. æ¸…ç†åºŸå¼ƒçš„ .bak æ–‡ä»¶

**ç¬¬2-3å‘¨ï¼ˆé‡æ„ä¼˜åŒ–ï¼‰**ï¼š
1. é‡æ„ frontend/test_frontend_flow.pyï¼Œä½¿ç”¨fixtureæ›¿ä»£ç±»å˜é‡
2. ç§»é™¤ test_product_id fixtureçš„è‡ªåŠ¨åˆ›å»ºé€»è¾‘

**ç¬¬4-6å‘¨ï¼ˆæ¶æ„å‡çº§ï¼‰**ï¼š
1. å¼•å…¥æ•°æ®å·¥å‚æ¨¡å¼ï¼ˆfactoriesç›®å½•ï¼‰
2. æ¨¡å—åŒ–fixturesï¼ˆfixturesç›®å½•ï¼‰

**ç¬¬7-12å‘¨ï¼ˆé•¿æœŸå»ºè®¾ï¼‰**ï¼š
1. å¼•å…¥pytest-xdistæ”¯æŒå¹¶è¡Œæµ‹è¯•
2. å»ºç«‹æµ‹è¯•è¦†ç›–ç‡è´¨é‡é—¨ç¦
3. å¼•å…¥Mockæœºåˆ¶ä¼˜åŒ–æµ‹è¯•æ€§èƒ½

---

### 8.3 å…³é”®å»ºè®®

1. **ç«‹å³è¡ŒåŠ¨**ï¼šä¼˜å…ˆä¿®å¤tokené»‘åå•é—®é¢˜ï¼Œè¿™æ˜¯å½±å“æµ‹è¯•ç¨³å®šæ€§çš„æ ¹æœ¬åŸå› 

2. **å›¢é˜Ÿåä½œ**ï¼šå»ºè®®å»ºç«‹"æµ‹è¯•ä»£ç å®¡æŸ¥æ¸…å•"ï¼ŒåŒ…æ‹¬ï¼š
   - [ ] æ˜¯å¦ä½¿ç”¨ç±»å˜é‡å…±äº«çŠ¶æ€ï¼Ÿ
   - [ ] æ˜¯å¦å­˜åœ¨éšå¼çš„æ‰§è¡Œé¡ºåºä¾èµ–ï¼Ÿ
   - [ ] fixtureæ˜¯å¦åœ¨æ‰§è¡Œå‰¯ä½œç”¨ï¼Ÿ

3. **æ–‡æ¡£å»ºè®¾**ï¼šè¡¥å……æµ‹è¯•ç¼–å†™è§„èŒƒæ–‡æ¡£ï¼Œæ˜ç¡®æœ€ä½³å®è·µ

4. **å·¥å…·åŒ–**ï¼šå¼€å‘ä¾èµ–åˆ†æå·¥å…·ï¼Œå¸®åŠ©è¯†åˆ«é—®é¢˜æ¨¡å¼

---

## é™„å½•

### A. æµ‹è¯•ç”¨ä¾‹ç»Ÿè®¡

| æ¨¡å— | æµ‹è¯•æ–‡ä»¶æ•° | æµ‹è¯•ç”¨ä¾‹æ•° |
|------|-----------|-----------|
| admin | 7 | 45 |
| shop_owner | 7 | 38 |
| auth | 2 | 15 |
| frontend | 5 | 25 |
| **æ€»è®¡** | **21** | **123** |

### B. ä¾èµ–å…³ç³»å¯è§†åŒ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Fixtureä¾èµ–å…³ç³»å›¾                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚   api_base_url                              â”‚
â”‚       â”‚                                     â”‚
â”‚   admin_token â”€â”€â†’ test_shop_id              â”‚
â”‚       â”‚              â”‚                      â”‚
â”‚       â”‚              â””â”€â”€â†’ test_product_id   â”‚
â”‚       â”‚                                     â”‚
â”‚   shop_owner_token (ä¾èµ–admin_token)         â”‚
â”‚       â”‚                                     â”‚
â”‚       â””â”€â”€â†’ test_order_id                     â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### C. æ‰§è¡Œé¡ºåºå¼ºåˆ¶æ˜ å°„

```python
# conftest.py ä¼˜å…ˆçº§æ˜ å°„
priority_map = {
    "test_frontend_flow.py": 0,    # æœ€å…ˆæ‰§è¡Œ
    "test_business_flow.py": 50,    # ä¸­ç­‰ä¼˜å…ˆçº§
    "test_auth_flow.py": 100,       # æœ€åæ‰§è¡Œ
}
```

---

**æŠ¥å‘Šå®Œæˆæ—¶é—´**ï¼š2025-01-04  
**åˆ†æä»£ç é‡**ï¼šçº¦ 5,000 è¡Œæµ‹è¯•ä»£ç   
**è¯†åˆ«é—®é¢˜æ•°**ï¼š5 ä¸ªå…³é”®é—®é¢˜ï¼Œ12 ä¸ªä¼˜åŒ–å»ºè®®
